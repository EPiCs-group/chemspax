
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChemSpaX &#8212; ChemSpaX  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to ChemSpaX’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="chemspax">
<h1>ChemSpaX<a class="headerlink" href="#chemspax" title="Permalink to this headline">¶</a></h1>
<p>ChemSpaX can be used for local chemical space exploration of any structure.
This is done by placing substuents on a skeleton.
Two approaches were considered:</p>
<ol class="arabic simple">
<li><p>From a library of existing substituents choose a substituent and
attach it the skeleton.
See attach_substituent.py.</p></li>
<li><p>The user inputs an atom to be functionalized on a skeleton complex,
then a tetrahedron is formed around this atom and this atom can be replaced.
See generate_tetrahedron.py. <strong>This approach is outdated and not maintained</strong></p></li>
</ol>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Python 3.6.0 or higher is recommended.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">EPiCs</span><span class="o">-</span><span class="n">group</span><span class="o">/</span><span class="n">chemspax</span>
</pre></div>
</div>
<p>It is recommended to use a virtual environment. Anaconda can be used to manage virtual environments (<strong>using Anaconda allows the user to skip
compilation of openbabel from source</strong>):<br />
Download the latest installer from
<a class="reference external" href="https://www.anaconda.com/products/individual">Anaconda’s website</a>.<br />
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">Anaconda3</span><span class="o">-</span><span class="mf">2020.07</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Then run the installation script with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">bash</span> <span class="n">Anaconda3</span><span class="o">-</span><span class="mf">2020.07</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>  
</pre></div>
</div>
<p>The installation is pretty self explanatory, afterwards the following commands can be used to
create a virtual environment and activate it.<br />
The environment will be named ‘chemspax’, the conda_env.yml file can be changed if a different name is required.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">conda_env</span><span class="o">.</span><span class="n">yml</span>

<span class="n">conda</span> <span class="n">activate</span> <span class="n">chemspax</span>
</pre></div>
</div>
<p>Check if the environment is installed correctly by running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="nb">list</span>
</pre></div>
</div>
<p>More information on virtual environments can be found at the
<a class="reference external" href="https://docs.python.org/3/library/venv.html">venv homepage</a> or
<a class="reference external" href="https://uoa-eresearch.github.io/eresearch-cookbook/recipe/2014/11/20/conda/">this Anaconda cheatsheet</a></p>
</div>
<div class="section" id="instructions">
<h2>Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">¶</a></h2>
<p>First, we need to prepare the xyz file of the skeleton to which we want to attach a substituent.
An example .xyz file of a skeleton in the skeletons/ folder looks like this:
<img alt="example" src="_images/example_functionalization_list.jpg" /></p>
<p>In the functionalization_list each item is a functionalization. In the example figure shown below,
4 functionalizations are done.<br />
The first item of each list (red circle) is the index of the atom_to_be_functionalized (the atom that will
be replaced by the substituent).</p>
<p><strong>Since commit <a class="reference external" href="https://github.com/EPiCs-group/chemspax/commit/bf59491b619c5064c1314848e2d4d8eb31e7d71d">bf59491</a> all hydrogens are functionalized (used as atom_to_be_functionalized)
if no functionalization_list is given in the skeleton’s xyz file (second line is empty). This preparation step can thus be skipped if
the whole structure needs to be functionalized instead of specific indices.</strong></p>
<p>Make sure to put no spaces in this functionalization_list. Since
<code class="docutils literal notranslate"><span class="pre">sys.argv()</span></code> is used in the main.py files, each space might be interpreted as a new argument
to the function. Also note that index 0 is the <strong>first atom in the xyz file</strong>.
In the example figure above, the index of Ru = 0.<br />
<img alt="example" src="_images/example_atom_to_be_functionalized.jpg" /></p>
<p>The second item of each list (green circle) is the index of the bonded_atom, this is the
skeleton’s atom that will be bonded to the substituent.</p>
<p><img alt="example" src="_images/example_bonded_atom.jpg" /></p>
<p>With these instructions the user should be able to
write the functionalization_list of the skeletons correctly to
the skeleton’s xyz file and this skeleton’s xyz file should be
moved to the  skeletons/ folder (<strong>note: there should be no newline at the end of the xyz file!</strong>).<br />
To attach a substituent to this skeleton, an
explanation is given on how to proceed with the next 2 steps.</p>
<div class="section" id="attach-substituent-py">
<h3>attach_substituent.py<a class="headerlink" href="#attach-substituent-py" title="Permalink to this headline">¶</a></h3>
<p><strong>Note: Make sure to check the relative path on line 175, 88, 66
and 21 are correctly set if you want to use attach_substituent.py directly.<br />
It is recommended to keep everything as default and use the
functionalize_and_optimize_obabel.sh or
functionalize_and_optimize_xtb.sh scripts instead, which will be explained.</strong></p>
<div class="section" id="choosing-from-library-adding-a-substituent-to-library">
<h4>1 Choosing from library/adding a substituent to library<a class="headerlink" href="#choosing-from-library-adding-a-substituent-to-library" title="Permalink to this headline">¶</a></h4>
<p>The user can upload manually generated substituents
to substituents_xyz/manually_generated/ or use the pre-made substituents
contained in that folder.</p>
<div class="section" id="use-pre-made-substituents">
<h5>Use pre-made substituents<a class="headerlink" href="#use-pre-made-substituents" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>Move skeleton’s xyz file to skeletons/ folder</p></li>
<li><p>Run data_preparation.py</p></li>
<li><p>Go to step 2</p></li>
</ul>
</div>
<div class="section" id="optional-add-new-substituent">
<h5>(optional) Add new substituent<a class="headerlink" href="#optional-add-new-substituent" title="Permalink to this headline">¶</a></h5>
<p>I’ll take the example of methyl (which is already in the substituents_xyz/manually_generated folder):</p>
<ul class="simple">
<li><p>Take an xyz file for (optimized) CH4, then remove one of the hydrogens, this is where the substituent will form a bond with the skeleton.</p></li>
<li><p>Let the C (central atom of the
substituent) be the first atom in the list of atoms in the xyz file. (by moving C to the third line of the xyz file)</p></li>
<li><p>Save the xyz file in substituents_xyz/manually_generated</p></li>
<li><p>Run data_preparation.py to be able to use this substituent for functionalizations</p></li>
<li><p>Go to step 2</p></li>
</ul>
<p>data_preparation.py is used to add the central atom and centroid vector per substituent to a .csv file
as these will be used to align the substituent with the skeleton. This script also manages to conversion between .mol and .xyz files.
Note that it is recommended to provide .mol files when available, since these provide correct connectivity data for a structure.
<strong>data_preparation.py assumes that the central atom of the substituent (C in the case of CH3) is the first atom in the
.xyz file of the substituent and that the central atom of the substituent
has a free electron pair such that a new bond can be formed!</strong></p>
<p>An example of the .csv file with information for each substituent
as generated by data_preparation.py is shown below:
<img alt="example" src="_images/example_csv_database.jpg" /></p>
<p>After correct preparation of the xyz/mol files for the skeleton and
(new) substituents and running data_preparation.py as explained above,
we can move on to the next step.</p>
</div>
</div>
<div class="section" id="attaching-substituent-s-to-skeleton-s">
<h4>2 Attaching substituent(s) to skeleton(s)<a class="headerlink" href="#attaching-substituent-s-to-skeleton-s" title="Permalink to this headline">¶</a></h4>
<p>The user can use the
functionalize_and_optimize_obabel.sh or
functionalize_and_optimize_xtb.sh scripts to generate their functionalized complexes.
In these scripts the $STARTING_C_SUBSTITUENT should be the first substituent to place on the skeleton,
the $RANDOM_C_SUBSTITUENTS should be a list of substituents that should be added after that.
The amount of substituents should match the amount of functionalization sites specified in the
xyz file of the skeleton.<br />
For example, if the user would like to place 4 methyl groups on a skeleton (as defined in the example skeleton xyz file in the pictures above)
and optimize each functionalization with
FF, functionalize_and_optimize_obabel.sh needs to be edited to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># select 1 random substituent with C as central atom as starting point</span>
<span class="n">STARTING_C_SUBSTITUENT</span><span class="o">=</span><span class="s2">&quot;CH3&quot;</span>
<span class="c1"># select 3 random substituents with C as central atom</span>
<span class="n">RANDOM_C_SUBSTITUENTS</span><span class="o">=</span><span class="s2">&quot;CH3 CH3 CH3&quot;</span>
</pre></div>
</div>
<p>After this edit the script can be run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">functionalize_and_optimize_obabel</span><span class="o">.</span><span class="n">sh</span> <span class="n">C</span>
</pre></div>
</div>
<p>If the STARTING_C_SUBSTITUENT and RANDOM_C_SUBSTITUENT variables are not modified, the C argument means that 6 random carbon substituents
will be placed. Similarly, the P argument will call the functionalize_skeletons_P_substituents function and 6 random phosphorus substituents will
be placed on the indicated sites of the skeleton. <strong>The P and CP arguments have not been tested as thoroughly as the C argument</strong>.</p>
<p>In the example shown here, 4 xyz and 4 .mol files in substituents_xyz/automatically_generated should be generated,
one for each functionalized structure. The .mol files contain the correcly optimized functionalized structures.<br />
This workflow is similar if the user would like to optimize
every functionalized skeleton with xTB, but then the functionalize_and_optimize_xtb.sh
script should be edited and used.</p>
</div>
<div class="section" id="done">
<h4>Done<a class="headerlink" href="#done" title="Permalink to this headline">¶</a></h4>
<p>More information for devs:<br />
The Complex.generate_substituent_and_write_xyz()
function from attach_substituent.py is used to functionalize a skeleton. The main_attach_substituent.py takes the following
input:</p>
<ol class="arabic simple">
<li><p>path_to_source_file</p></li>
<li><p>target_name (<strong>Note: name only, the file will always be placed in
substituents_xyz/automatically_generated with extension .xyz</strong>)</p></li>
<li><p>name of substituent group (same as key in .csv database)</p></li>
<li><p>relative path to .csv database file</p></li>
<li><p>bond length between central atom of the substituent and bonded_atom of skeleton</p></li>
<li><p>(Not used currently) whether the user wants to use the python script with the xtb bash script, in the
xtb bash script the conversion of the optimized .mol file to .xyz file doesn’t happen in python.
If this is set to false only ff optimization will be done and the python script will handle file conversions.</p></li>
</ol>
<p>Where each input value is given as a space delimited system argument.
The user can modify the example of attach_substituent_folder/run.sh
to their needs or use attach_substituent.py directly.</p>
<p><strong>(outdated) generate_tetrahedron.py</strong></p>
<p><strong>Note: Make sure to check the relative path on line 124
is correctly set, relatively to your working directory. This
script is not actively used anymore, it is recommended to use the approach
described under attach_substituent.py.</strong></p>
<p>To functionalize a skeleton using this approach, now the bond lengths
between bonded_atom and central_atom of substituent and
surrounding atoms of the substituent with central_atom of substituent is needed.
The main_generate_tetrahedron.py takes input values as follows:</p>
<ol class="arabic simple">
<li><p>path_to_source_file</p></li>
<li><p>target_name (<strong>Note: name only, the file will always be placed in
substituents_xyz/automatically_generated with extension .xyz</strong>)</p></li>
<li><p>bond length of new central atom of substituent with bonded_atom</p></li>
<li><p>actual new central atom of substituent</p></li>
<li><p>bond length of new central atom of substituent with first surrounding
substituent atom</p></li>
<li><p>actual first surrounding substituent atom</p></li>
<li><p>same as 5) for second surrounding substituent atom</p></li>
<li><p>same as 6) for second surrounding substituent atom</p></li>
<li><p>same as 5) for third surrounding substituent atom</p></li>
<li><p>same as 6) for third surrounding substituent atom</p></li>
</ol>
<p>Where each input value is given as a space delimited system argument.
The user can modify the example of generate_tetrahedron_folder/run.sh
to their needs or use generate_tetrahedron.py directly.</p>
</div>
</div>
</div>
<div class="section" id="outdated-example-usage-of-python-scripts-only">
<h2>(outdated) Example usage of python scripts only<a class="headerlink" href="#outdated-example-usage-of-python-scripts-only" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">generate_tetrahedron_folder/run.sh</span></code> to functionalize a RuPNP skeleton where 4 H sites
will be substituted for methyl groups using generate_tetrahedron.py</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">attach_substituent_folder/run.sh</span></code> to functionalize a RuPNP skeleton where
6 sites will be functionalized with substituents</p></li>
</ul>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<p><strong>skeletons/</strong></p>
<ul class="simple">
<li><p>contains .xyz files of skeletons to be functionalized.</p></li>
</ul>
<p><strong>substituents_xyz/</strong></p>
<ul class="simple">
<li><p>contains .xyz files for substituents and functionalized skeletons</p>
<ul>
<li><p>automatically_generated/: output of functionalized skeletons by attach_substituent.py.
If functionalize_and_optimize_xtb.sh is used the xTB optimized structures are placed in the optimized_structures/ subfolder.</p></li>
<li><p>manually_generated/: Substituents that will be attached to skeletons in attach_substituent.py.</p></li>
<li><p>old/: contains substituents that became either obsolete or will be dealt with later.</p></li>
<li><p>visualizations/: contains .png files of the functionalizations made in generate_tetrahedron.py</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this headline">¶</a></h2>
<p>If you use ChemSpaX, please cite:</p>
<div class="csl-entry">Kalikadien, A. V, Pidko, E. A., &#38; Sinha, V. (2022). ChemSpaX: Exploration of chemical space by automated functionalization of molecular scaffold. <i>Digital Discovery</i>. <a href="https://doi.org/10.1039/D1DD00017A">https://doi.org/10.1039/D1DD00017A</a></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ChemSpaX</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ChemSpaX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#instructions">Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outdated-example-usage-of-python-scripts-only">(outdated) Example usage of python scripts only</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#citation">Citation</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to ChemSpaX’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, A.V. Kalikadien, V. Sinha.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/README.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>